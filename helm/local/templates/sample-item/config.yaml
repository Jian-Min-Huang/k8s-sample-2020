{{ $activeProfiles := .Values.activeProfiles }}
{{ $mysqlUrl := .Values.stage.mysql.url }}
{{ $mysqlUsername := .Values.stage.mysql.username }}
{{ $mysqlPassword := .Values.stage.mysql.password }}
{{ $jaegerHost := .Values.stage.jaeger.host }}

apiVersion: v1
kind: ConfigMap
metadata:
  name: sample-item-{{ $activeProfiles }}
  labels:
    app: sample-item-{{ $activeProfiles }}
data:
  TZ: Asia/Taipei
  activeProfiles: {{ $activeProfiles }}
  application.yml: |-
    spring:
      profiles: {{ $activeProfiles }}
      datasource:
        url: {{ $mysqlUrl }}
        username: {{ $mysqlUsername }}
        password: {{ $mysqlPassword }}
    opentracing:
      jaeger:
        udp-sender:
          host: {{ $jaegerHost }}
